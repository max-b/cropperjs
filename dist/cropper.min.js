/*!
 * Cropper v0.2.0
 * https://github.com/fengyuanchen/cropperjs
 *
 * Copyright (c) 2015 Fengyuan Chen
 * Released under the MIT license
 *
 * Date: 2015-11-10T04:39:25.057Z
 */
!function(t,i){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?i(t,!0):function(t){if(!t.document)throw new Error("Cropper requires a window with a document");return i(t)}:i(t)}("undefined"!=typeof window?window:this,function(t,i){"use strict";function e(t){return St.call(t).match(lt)[1].toLowerCase()}function a(t){return"string"==typeof t}function h(t){return"number"==typeof t&&!isNaN(t)}function n(t){return"undefined"==typeof t}function s(t){return"object"==typeof t&&null!==t}function o(t){var i,e;if(!s(t))return!1;try{return i=t.constructor,e=i.prototype,i&&e&&Pt.call(e,"isPrototypeOf")}catch(a){return!1}}function r(t){return"function"===e(t)}function c(t){return Array.isArray?Array.isArray(t):"array"===e(t)}function p(t,i){var e=[];return h(i)&&e.push(i),e.slice.apply(t,e)}function l(t,i){var e=-1;return g(i,function(i,a){return i===t?(e=a,!1):void 0}),e}function d(t){return"number"==typeof t?t?0>t?-1:1:t===t?0:NaN:NaN}function u(t){return a(t)||(t=String(t)),t=t.trim?t.trim():t.replace(dt,"$1")}function g(t,i){var e,a;if(t&&r(i))if(c(t)||h(t.length))for(a=0,e=t.length;e>a&&i.call(t,t[a],a,t)!==!1;a++);else if(s(t))for(a in t)if(Pt.call(t,a)&&i.call(t,t[a],a,t)===!1)break;return t}function f(t){var i=p(arguments);return i.length>1&&i.shift(),g(i,function(i){g(i,function(i,e){t[e]=i})}),t}function m(t,i){var e=p(arguments,2);return function(){return t.apply(i,e.concat(p(arguments)))}}function v(t){return u(t).split(pt)}function w(t,i){return t.className.indexOf(i)>-1}function x(t,i){var e;return h(t.length)?g(t,function(t){x(t,i)}):(e=v(t.className),g(v(i),function(t){l(t,e)<0&&e.push(t)}),void(t.className=e.join(" ")))}function b(t,i){var e;return h(t.length)?g(t,function(t){b(t,i)}):(e=v(t.className),g(v(i),function(t,i){(i=l(t,e))>-1&&e.splice(i,1)}),void(t.className=e.join(" ")))}function D(t,i,e){return e?x(t,i):b(t,i)}function C(t,i){return s(t[i])?t[i]:t.dataset?t.dataset[i]:t.getAttribute("data-"+i)}function y(t,i,e){s(e)&&n(t[i])?t[i]=e:t.dataset?t.dataset[i]=e:t.setAttribute("data-"+i,e)}function B(t,i){s(t[i])?delete t[i]:t.dataset?delete t.dataset[i]:t.removeAttribute("data-"+i)}function T(t,i,e){var a;if(r(e))return a=u(i).split(pt),a.length>1?g(a,function(i){T(t,i,e)}):void(t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent&&t.attachEvent("on"+i,e))}function X(t,i,e){var a;if(r(e))return a=u(i).split(pt),a.length>1?g(a,function(i){X(t,i,e)}):void(t.removeEventListener?t.removeEventListener(i,e,!1):t.detachEvent&&t.detachEvent("on"+i,e))}function Y(t){t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)}function W(i){var e,a=i||t.event;return a.target||(a.target=a.srcElement||U),h(a.pageX)||(e=U.documentElement,a.pageX=a.clientX+(t.scrollX||e&&e.scrollLeft||0)-(e&&e.clientLeft||0),a.pageY=a.clientY+(t.scrollY||e&&e.scrollTop||0)-(e&&e.clientTop||0)),a}function L(i){var e=U.documentElement,a=i.getBoundingClientRect();return{left:a.left+(t.scrollX||e&&e.scrollLeft||0)-(e&&e.clientLeft||0),top:a.top+(t.scrollY||e&&e.scrollTop||0)-(e&&e.clientTop||0)}}function H(t,i){return t.querySelector(i)}function M(t,i){return t.querySelectorAll(i)}function E(t,i){t.parentNode.insertBefore(i,t)}function k(t,i){t.appendChild(i)}function R(t){t.parentNode.removeChild(t)}function z(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function I(t){var i=t.match(/^(https?:)\/\/([^\:\/\?#]+):?(\d*)/i);return i&&(i[1]!==j.protocol||i[2]!==j.hostname||i[3]!==j.port)}function N(t,i){i&&(t.crossOrigin=i)}function A(t){var i="timestamp="+(new Date).getTime();return t+(-1===t.indexOf("?")?"?":"&")+i}function S(t,i){var e;return t.naturalWidth?i(t.naturalWidth,t.naturalHeight):(e=U.createElement("img"),e.onload=function(){i(this.width,this.height)},void(e.src=t.src))}function P(t){var i=[],e=t.rotate,a=t.scaleX,n=t.scaleY;return h(e)&&i.push("rotate("+e+"deg)"),h(a)&&h(n)&&i.push("scale("+a+","+n+")"),i.length?i.join(" "):"none"}function O(t,i){var e,a,h=Et(t.degree)%180,n=(h>90?180-h:h)*Math.PI/180,s=kt(n),o=Rt(n),r=t.width,c=t.height,p=t.aspectRatio;return i?(e=r/(o+s/p),a=e/p):(e=r*o+c*s,a=r*s+c*o),{width:e,height:a}}function _(t,i){var e,a,n,s=U.createElement("canvas"),o=s.getContext("2d"),r=0,c=0,p=i.naturalWidth,l=i.naturalHeight,d=i.rotate,u=i.scaleX,g=i.scaleY,f=h(u)&&h(g)&&(1!==u||1!==g),m=h(d)&&0!==d,v=m||f,w=p,x=l;return f&&(e=p/2,a=l/2),m&&(n=O({width:p,height:l,degree:d}),w=n.width,x=n.height,e=n.width/2,a=n.height/2),s.width=w,s.height=x,v&&(r=-p/2,c=-l/2,o.save(),o.translate(e,a)),m&&o.rotate(d*Math.PI/180),f&&o.scale(u,g),o.drawImage(t,r,c,p,l),v&&o.restore(),s}function Z(t,i){this.element=t,this.options=f({},Z.DEFAULTS,o(i)&&i),this.ready=!1,this.built=!1,this.complete=!1,this.rotated=!1,this.cropped=!1,this.disabled=!1,this.replaced=!1,this.isImg=!1,this.originalUrl="",this.crossOrigin="",this.canvasData=null,this.cropBoxData=null,this.previews=null,this.init()}var U=t.document,j=t.location,q="cropper",F="cropper-modal",$="cropper-hide",K="cropper-hidden",V="cropper-invisible",G="cropper-move",J="cropper-crop",Q="cropper-disabled",tt="cropper-bg",it="mousedown touchstart pointerdown MSPointerDown",et="mousemove touchmove pointermove MSPointerMove",at="mouseup touchend touchcancel pointerup pointercancel MSPointerUp MSPointerCancel",ht="wheel mousewheel DOMMouseScroll",nt="dblclick",st="resize",ot="error",rt="load",ct=/^(e|w|s|n|se|sw|ne|nw|all|crop|move|zoom)$/,pt=/\s+/,lt=/\s([a-zA-Z]+)/,dt=/^\s+(.*)\s+^/,ut="preview",gt="action",ft="e",mt="w",vt="s",wt="n",xt="se",bt="sw",Dt="ne",Ct="nw",yt="all",Bt="crop",Tt="move",Xt="zoom",Yt="none",Wt=!!U.createElement("canvas").getContext,Lt=Number,Ht=Math.min,Mt=Math.max,Et=Math.abs,kt=Math.sin,Rt=Math.cos,zt=Math.sqrt,It=Math.round,Nt={version:"0.2.0"},At={},St=At.toString,Pt=At.hasOwnProperty;f(Nt,{init:function(){var t,i=this.element,e=i.tagName.toLowerCase();if(!C(i,q)){if(y(i,q,this),"img"===e){if(this.isImg=!0,this.originalUrl=t=i.getAttribute("src"),!t)return;t=i.src}else"canvas"===e&&Wt&&(t=i.toDataURL());this.load(t)}},load:function(t){var i,e,a,h,n,s=this.options,o=this.element;t&&(this.url=t,r(s.build)&&s.build.call(o)===!1||(s.checkImageOrigin&&I(t)&&(i=o.crossOrigin,i||(i="anonymous",e=A(t)),this.crossOrigin=i),a=U.createElement("img"),N(a,i),a.src=e||t,this.image=a,this._start=h=m(this.start,this),this._stop=n=m(this.stop,this),this.isImg?o.complete?this.start():T(o,rt,h):(T(a,rt,h),T(a,ot,n),x(a,$),E(o,a))))},start:function(t){var i=this.isImg?this.element:this.image;t&&(X(i,rt,this._start),X(i,ot,this._stop)),S(i,m(function(t,i){this.imageData={naturalWidth:t,naturalHeight:i,aspectRatio:t/i},this.ready=!0,this.build()},this))},stop:function(){var t=this.image;X(t,rt,this._start),X(t,ot,this._stop),R(t),this.image=null}}),f(Nt,{build:function(){var t,i,e,a,h,n,s=this.options,o=this.element,c=this.image;this.ready&&(this.built&&this.unbuild(),t=U.createElement("div"),t.innerHTML=Z.TEMPLATE,this.container=o.parentNode,this.cropper=i=H(t,".cropper-container"),this.canvas=e=H(i,".cropper-canvas"),this.dragBox=a=H(i,".cropper-drag-box"),this.cropBox=h=H(i,".cropper-crop-box"),this.viewBox=H(i,".cropper-view-box"),this.face=n=H(h,".cropper-face"),k(e,c),x(o,K),E(o,i),this.isImg||b(c,$),this.initPreview(),this.bind(),s.aspectRatio=Mt(0,s.aspectRatio)||NaN,s.autoCrop?(this.cropped=!0,s.modal&&x(a,F)):x(h,K),s.guides||x(M(h,".cropper-dashed"),K),s.center||x(H(h,".cropper-center"),K),s.background&&x(i,tt),s.highlight||x(n,V),s.cropBoxMovable&&(x(n,G),y(n,gt,yt)),s.cropBoxResizable||(x(M(h,".cropper-line"),K),x(M(h,".cropper-point"),K)),this.setDragMode(s.dragCrop?Bt:s.movable?Tt:Yt),this.render(),this.built=!0,this.setData(s.data),setTimeout(m(function(){r(s.built)&&s.built.call(o),r(s.crop)&&s.crop.call(o,this.getData()),this.complete=!0},this),0))},unbuild:function(){this.built&&(this.built=!1,this.initialImageData=null,this.initialCanvasData=null,this.initialCropBoxData=null,this.containerData=null,this.canvasData=null,this.cropBoxData=null,this.unbind(),this.resetPreview(),this.previews=null,this.viewBox=null,this.cropBox=null,this.dragBox=null,this.canvas=null,this.container=null,R(this.cropper),this.cropper=null)}}),f(Nt,{render:function(){this.initContainer(),this.initCanvas(),this.initCropBox(),this.renderCanvas(),this.cropped&&this.renderCropBox()},initContainer:function(){var t,i=this.options,e=this.element,a=this.container,h=this.cropper;x(h,K),b(e,K),this.containerData=t={width:Mt(a.offsetWidth,Lt(i.minContainerWidth)||200),height:Mt(a.offsetHeight,Lt(i.minContainerHeight)||100)},h.style.cssText="width:"+t.width+"px;height:"+t.height+"px",x(e,K),b(h,K)},initCanvas:function(){var t=this.containerData,i=t.width,e=t.height,a=this.imageData,h=a.aspectRatio,n={naturalWidth:a.naturalWidth,naturalHeight:a.naturalHeight,aspectRatio:h,width:i,height:e};e*h>i?n.height=i/h:n.width=e*h,n.oldLeft=n.left=(i-n.width)/2,n.oldTop=n.top=(e-n.height)/2,this.canvasData=n,this.limitCanvas(!0,!0),this.initialImageData=f({},a),this.initialCanvasData=f({},n)},limitCanvas:function(t,i){var e,a,h=this.options,n=h.strict,s=this.containerData,o=s.width,r=s.height,c=this.canvasData,p=c.aspectRatio,l=this.cropBoxData,d=this.cropped&&l,u=this.initialCanvasData||c;t&&(e=Lt(h.minCanvasWidth)||0,a=Lt(h.minCanvasHeight)||0,n&&(e?e=Mt(e,d?l.width:u.width):a?a=Mt(a,d?l.height:u.height):d&&(e=l.width,a=l.height,a*p>e?e=a*p:a=e/p)),e&&a?a*p>e?a=e/p:e=a*p:e?a=e/p:a&&(e=a*p),c.minWidth=e,c.minHeight=a,c.maxWidth=1/0,c.maxHeight=1/0),i&&(n?(c.minLeft=d?Ht(l.left,l.left+l.width-c.width):Ht(0,o-c.width),c.minTop=d?Ht(l.top,l.top+l.height-c.height):Ht(0,r-c.height),c.maxLeft=d?l.left:Mt(0,o-c.width),c.maxTop=d?l.top:Mt(0,r-c.height)):(c.minLeft=-c.width,c.minTop=-c.height,c.maxLeft=o,c.maxTop=r))},renderCanvas:function(t){var i,e,a=this.options,h=this.canvasData,n=this.imageData,s=n.rotate,o=n.naturalWidth,r=n.naturalHeight;this.rotated&&(this.rotated=!1,e=O({width:n.width,height:n.height,degree:s}),i=e.width/e.height,i!==h.aspectRatio&&(h.left-=(e.width-h.width)/2,h.top-=(e.height-h.height)/2,h.width=e.width,h.height=e.height,h.aspectRatio=i,h.naturalWidth=o,h.naturalHeight=r,s%180&&(e=O({width:o,height:r,degree:s}),h.naturalWidth=e.width,h.naturalHeight=e.height),this.limitCanvas(!0,!1))),(h.width>h.maxWidth||h.width<h.minWidth)&&(h.left=h.oldLeft),(h.height>h.maxHeight||h.height<h.minHeight)&&(h.top=h.oldTop),h.width=Ht(Mt(h.width,h.minWidth),h.maxWidth),h.height=Ht(Mt(h.height,h.minHeight),h.maxHeight),this.limitCanvas(!1,!0),h.oldLeft=h.left=Ht(Mt(h.left,h.minLeft),h.maxLeft),h.oldTop=h.top=Ht(Mt(h.top,h.minTop),h.maxTop),this.canvas.style.cssText="width:"+h.width+"px;height:"+h.height+"px;left:"+h.left+"px;top:"+h.top+"px;",this.renderImage(),this.cropped&&a.strict&&this.limitCropBox(!0,!0),t&&this.output()},renderImage:function(t){var i,e=this.canvasData,a=this.imageData;a.rotate&&(i=O({width:e.width,height:e.height,degree:a.rotate,aspectRatio:a.aspectRatio},!0)),f(a,i?{width:i.width,height:i.height,left:(e.width-i.width)/2,top:(e.height-i.height)/2}:{width:e.width,height:e.height,left:0,top:0}),this.image.style.cssText="width:"+a.width+"px;height:"+a.height+"px;margin-left:"+a.left+"px;margin-top:"+a.top+"px;transform:"+P(a),t&&this.output()},initCropBox:function(){var t=this.options,i=t.aspectRatio,e=Lt(t.autoCropArea)||.8,a=this.canvasData,h={width:a.width,height:a.height};i&&(a.height*i>a.width?h.height=h.width/i:h.width=h.height*i),this.cropBoxData=h,this.limitCropBox(!0,!0),h.width=Ht(Mt(h.width,h.minWidth),h.maxWidth),h.height=Ht(Mt(h.height,h.minHeight),h.maxHeight),h.width=Mt(h.minWidth,h.width*e),h.height=Mt(h.minHeight,h.height*e),h.oldLeft=h.left=a.left+(a.width-h.width)/2,h.oldTop=h.top=a.top+(a.height-h.height)/2,this.initialCropBoxData=f({},h)},limitCropBox:function(t,i){var e,a,h,n,s=this.options,o=s.strict,r=this.containerData,c=r.width,p=r.height,l=this.canvasData,d=this.cropBoxData,u=s.aspectRatio;t&&(e=Lt(s.minCropBoxWidth)||0,a=Lt(s.minCropBoxHeight)||0,e=Ht(e,c),a=Ht(a,p),h=Ht(c,o?l.width:c),n=Ht(p,o?l.height:p),u&&(e&&a?a*u>e?a=e/u:e=a*u:e?a=e/u:a&&(e=a*u),n*u>h?n=h/u:h=n*u),d.minWidth=Ht(e,h),d.minHeight=Ht(a,n),d.maxWidth=h,d.maxHeight=n),i&&(o?(d.minLeft=Mt(0,l.left),d.minTop=Mt(0,l.top),d.maxLeft=Ht(c,l.left+l.width)-d.width,d.maxTop=Ht(p,l.top+l.height)-d.height):(d.minLeft=0,d.minTop=0,d.maxLeft=c-d.width,d.maxTop=p-d.height))},renderCropBox:function(){var t=this.options,i=this.containerData,e=i.width,a=i.height,h=this.cropBoxData;(h.width>h.maxWidth||h.width<h.minWidth)&&(h.left=h.oldLeft),(h.height>h.maxHeight||h.height<h.minHeight)&&(h.top=h.oldTop),h.width=Ht(Mt(h.width,h.minWidth),h.maxWidth),h.height=Ht(Mt(h.height,h.minHeight),h.maxHeight),this.limitCropBox(!1,!0),h.oldLeft=h.left=Ht(Mt(h.left,h.minLeft),h.maxLeft),h.oldTop=h.top=Ht(Mt(h.top,h.minTop),h.maxTop),t.movable&&t.cropBoxDataMovable&&y(this.face,gt,h.width===e&&h.height===a?Tt:yt),this.cropBox.style.cssText="width:"+h.width+"px;height:"+h.height+"px;left:"+h.left+"px;top:"+h.top+"px;",this.cropped&&t.strict&&this.limitCanvas(!0,!0),this.disabled||this.output()},output:function(){var t=this.options;this.preview(),this.complete&&r(t.crop)&&t.crop.call(this.element,this.getData())}}),f(Nt,{initPreview:function(){var t,i=this.options.preview,e=U.createElement("img"),a=this.crossOrigin,h=this.url;N(e,a),e.src=h,k(this.viewBox,e),i&&(this.previews=t=M(U,i),g(t,function(t){var i=U.createElement("img");y(t,ut,{width:t.offsetWidth,height:t.offsetHeight,html:t.innerHTML}),N(i,a),i.src=h,i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important"',z(t),k(t,i)}))},resetPreview:function(){g(this.previews,function(t){t.innerHTML=C(t,ut).html,B(t,ut)})},preview:function(){var t=this.imageData,i=this.canvasData,e=this.cropBoxData,a=e.width,h=e.height,n=t.width,s=t.height,o=e.left-i.left-t.left,r=e.top-i.top-t.top;this.cropped&&!this.disabled&&(H(this.viewBox,"img").style.cssText="width:"+n+"px;height:"+s+"px;margin-left:"+-o+"px;margin-top:"+-r+"px;transform:"+P(t),g(this.previews,function(i){var e=C(i,ut),c=e.width,p=e.height,l=c,d=p,u=1,g=i.style,f=H(i,"img").style;a&&(u=c/a,d=h*u),h&&d>p&&(u=p/h,l=a*u,d=p),g.width=l+"px",g.height=d+"px",f.width=n*u+"px",f.height=s*u+"px",f.marginLeft=-o*u+"px",f.marginTop=-r*u+"px",f.transform=P(t)}))}}),f(Nt,{bind:function(){var i=this.options,e=this.cropper;T(e,it,m(this.cropStart,this)),i.zoomable&&i.mouseWheelZoom&&T(e,ht,m(this.wheel,this)),i.doubleClickToggle&&T(e,nt,m(this.dblclick,this)),T(U,et,this._cropMove=m(this.cropMove,this)),T(U,at,this._cropEnd=m(this.cropEnd,this)),i.responsive&&T(t,st,this._resize=m(this.resize,this))},unbind:function(){var i=this.options,e=this.cropper;X(e,it,this.cropStart),i.zoomable&&i.mouseWheelZoom&&X(e,ht,this.wheel),i.doubleClickToggle&&X(e,nt,this.dblclick),X(U,et,this._cropMove),X(U,at,this._cropEnd),i.responsive&&X(t,st,this._resize)}}),f(Nt,{resize:function(){var t,i,e,a=this.container,h=this.containerData;!this.disabled&&h&&(e=a.offsetWidth/h.width,(1!==e||a.offsetHeight!==h.height)&&(t=this.getCanvasData(),i=this.getCropBoxData(),this.render(),this.setCanvasData(g(t,function(i,a){t[a]=i*e})),this.setCropBoxData(g(i,function(t,a){i[a]=t*e}))))},dblclick:function(){this.disabled||this.setDragMode(w(this.dragBox,J)?Tt:Bt)},wheel:function(t){var i=W(t),e=Lt(this.options.wheelZoomRatio)||.1,a=1;this.disabled||(Y(i),i.deltaY?a=i.deltaY>0?1:-1:i.wheelDelta?a=-i.wheelDelta/120:i.detail&&(a=i.detail>0?1:-1),this.zoom(-a*e,i))},cropStart:function(t){var i,e,a,h=this.options,n=W(t),s=n.touches;if(!this.disabled){if(s){if(i=s.length,i>1){if(!h.zoomable||!h.touchDragZoom||2!==i)return;e=s[1],this.startX2=e.pageX,this.startY2=e.pageY,a=Xt}e=s[0]}if(a=a||C(n.target,gt),ct.test(a)){if(r(h.cropstart)&&h.cropstart.call(this.element,{originalEvent:n,action:a})===!1)return;Y(n),this.action=a,this.cropping=!1,this.startX=e?e.pageX:n.pageX,this.startY=e?e.pageY:n.pageY,a===Bt&&(this.cropping=!0,x(this.dragBox,F))}}},cropMove:function(t){var i,e,a=this.options,h=W(t),n=h.touches,s=this.action;if(!this.disabled){if(n){if(i=n.length,i>1){if(!a.zoomable||!a.touchDragZoom||2!==i)return;e=n[1],this.endX2=e.pageX,this.endY2=e.pageY}e=n[0]}if(s){if(r(a.cropmove)&&a.cropmove.call(this.element,{originalEvent:h,action:s})===!1)return;Y(h),this.endX=e?e.pageX:h.pageX,this.endY=e?e.pageY:h.pageY,this.change(h.shiftKey,h)}}},cropEnd:function(t){var i=this.options,e=W(t),a=this.action;this.disabled||a&&(Y(e),this.cropping&&(this.cropping=!1,D(this.dragBox,F,this.cropped&&i.modal)),this.action="",r(i.cropend)&&i.cropend.call(this.element,{originalEvent:e,action:a}))}}),f(Nt,{change:function(t,i){var e,a,h=this.options,n=h.aspectRatio,s=this.action,o=this.containerData,r=this.canvasData,c=this.cropBoxData,p=c.width,l=c.height,u=c.left,g=c.top,f=u+p,m=g+l,v=0,w=0,x=o.width,D=o.height,y=!0,B=C(this.dragBox,gt)===Tt&&h.rotatable&&s!==yt;if(!n&&t&&(n=p&&l?p/l:1),h.strict&&(v=c.minLeft,w=c.minTop,x=v+Ht(o.width,r.width),D=w+Ht(o.height,r.height)),a={x:this.endX-this.startX,y:this.endY-this.startY},n&&(a.X=a.y*n,a.Y=a.x/n),B){var T,X,Y=0,W=d(g+l/2-i.pageY),H=d(i.pageX-(u+p/2));T=Math.atan(p/2/(l/2)),X=Math.atan((p/2+a.x)/(l/2));var M=W*(X-T);T=Math.atan(l/2/(p/2)),X=Math.atan((l/2+a.y)/(p/2));var E=H*(X-T);Y=(M+E)*(180/Math.PI),this.rotate(Y)}else switch(s){case yt:u+=a.x,g+=a.y;break;case ft:if(a.x>=0&&(f>=x||n&&(w>=g||m>=D))){y=!1;break}p+=a.x,n&&(l=p/n,g-=a.Y/2),0>p&&(s=mt,p=0);break;case wt:if(a.y<=0&&(w>=g||n&&(v>=u||f>=x))){y=!1;break}l-=a.y,g+=a.y,n&&(p=l*n,u+=a.X/2),0>l&&(s=vt,l=0);break;case mt:if(a.x<=0&&(v>=u||n&&(w>=g||m>=D))){y=!1;break}p-=a.x,u+=a.x,n&&(l=p/n,g+=a.Y/2),0>p&&(s=ft,p=0);break;case vt:if(a.y>=0&&(m>=D||n&&(v>=u||f>=x))){y=!1;break}l+=a.y,n&&(p=l*n,u-=a.X/2),0>l&&(s=wt,l=0);break;case Dt:if(n){if(a.y<=0&&(w>=g||f>=x)){y=!1;break}l-=a.y,g+=a.y,p=l*n}else a.x>=0?x>f?p+=a.x:a.y<=0&&w>=g&&(y=!1):p+=a.x,a.y<=0?g>w&&(l-=a.y,g+=a.y):(l-=a.y,g+=a.y);0>p&&0>l?(s=bt,l=0,p=0):0>p?(s=Ct,p=0):0>l&&(s=xt,l=0);break;case Ct:if(n){if(a.y<=0&&(w>=g||v>=u)){y=!1;break}l-=a.y,g+=a.y,p=l*n,u+=a.X}else a.x<=0?u>v?(p-=a.x,u+=a.x):a.y<=0&&w>=g&&(y=!1):(p-=a.x,u+=a.x),a.y<=0?g>w&&(l-=a.y,g+=a.y):(l-=a.y,g+=a.y);0>p&&0>l?(s=xt,l=0,p=0):0>p?(s=Dt,p=0):0>l&&(s=bt,l=0);break;case bt:if(n){if(a.x<=0&&(v>=u||m>=D)){y=!1;break}p-=a.x,u+=a.x,l=p/n}else a.x<=0?u>v?(p-=a.x,u+=a.x):a.y>=0&&m>=D&&(y=!1):(p-=a.x,u+=a.x),a.y>=0?D>m&&(l+=a.y):l+=a.y;0>p&&0>l?(s=Dt,l=0,p=0):0>p?(s=xt,p=0):0>l&&(s=Ct,l=0);break;case xt:if(n){if(a.x>=0&&(f>=x||m>=D)){y=!1;break}p+=a.x,l=p/n}else a.x>=0?x>f?p+=a.x:a.y>=0&&m>=D&&(y=!1):p+=a.x,a.y>=0?D>m&&(l+=a.y):l+=a.y;0>p&&0>l?(s=Ct,l=0,p=0):0>p?(s=bt,p=0):0>l&&(s=Dt,l=0);break;case Tt:this.move(a.x,a.y),y=!1;break;case Xt:this.zoom(function(t,i,e,a){var h=zt(t*t+i*i),n=zt(e*e+a*a);return(n-h)/h}(Et(this.startX-this.startX2),Et(this.startY-this.startY2),Et(this.endX-this.endX2),Et(this.endY-this.endY2)),i),this.startX2=this.endX2,this.startY2=this.endY2,y=!1;break;case Bt:(a.x||a.y)&&(e=L(this.cropper),u=this.startX-e.left,g=this.startY-e.top,p=c.minWidth,l=c.minHeight,a.x>0?s=a.y>0?xt:a.y<0?Dt:ft:a.x<0?(u-=p,s=a.y>0?bt:a.y<0?Ct:mt):s=a.y>0?vt:wt,a.y<0&&(g-=l),this.cropped||(this.cropped=!0,b(this.cropBox,K)))}y&&(c.width=p,c.height=l,c.left=u,c.top=g,this.action=s,this.renderCropBox()),this.startX=this.endX,this.startY=this.endY}}),f(Nt,{crop:function(){return this.built&&!this.disabled&&(this.cropped||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&x(this.dragBox,F),b(this.cropBox,K)),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.built&&!this.disabled&&(this.imageData=f({},this.initialImageData),this.canvasData=f({},this.initialCanvasData),this.cropBoxData=f({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(f(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(),this.renderCanvas(),b(this.dragBox,F),x(this.cropBox,K)),this},replace:function(t){return!this.disabled&&t&&(this.isImg&&(this.replaced=!0,this.element.src=t),this.options.data=null,this.load(t)),this},enable:function(){return this.built&&(this.disabled=!1,b(this.cropper,Q)),this},disable:function(){return this.built&&(this.disabled=!0,x(this.cropper,Q)),this},destroy:function(){var t=this.element,i=this.image;return this.ready?(this.isImg&&this.replaced&&(t.asrc=this.originalUrl),this.unbuild(),b(t,K)):this.isImg?t.off(rt,this.start):i&&R(i),B(t,q),this},move:function(t,i){var e=this.canvasData;return this.moveTo(n(t)?t:e.left+Lt(t),n(i)?i:e.top+Lt(i))},moveTo:function(t,i){var e=this.canvasData,a=!1;return n(i)&&(i=t),t=Lt(t),i=Lt(i),this.built&&!this.disabled&&this.options.movable&&(h(t)&&(e.left=t,a=!0),h(i)&&(e.top=i,a=!0),a&&this.renderCanvas(!0)),this},zoom:function(t,i){var e=this.canvasData;return t=Lt(t),t=0>t?1/(1-t):1+t,this.zoomTo(e.width*t/e.naturalWidth,i)},zoomTo:function(t,i){var e,a,h=this.options,n=this.canvasData,s=n.width,o=n.height,c=n.naturalWidth,p=n.naturalHeight;if(t=Lt(t),t>=0&&this.built&&!this.disabled&&h.zoomable){if(e=c*t,a=p*t,r(h.zoom)&&h.zoom.call(this.element,{originalEvent:i,oldRatio:s/c,ratio:e/c})===!1)return this;n.left-=(e-s)/2,n.top-=(a-o)/2,n.width=e,n.height=a,this.renderCanvas(!0),this.setDragMode(Tt)}return this},rotate:function(t){return this.rotateTo((this.imageData.rotate||0)+Lt(t))},rotateTo:function(t){return t=Lt(t),h(t)&&this.built&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.rotated=!0,this.renderCanvas(!0)),this},scale:function(t,i){var e=this.imageData,a=!1;return n(i)&&(i=t),t=Lt(t),i=Lt(i),this.built&&!this.disabled&&this.options.scalable&&(h(t)&&(e.scaleX=t,a=!0),h(i)&&(e.scaleY=i,a=!0),a&&this.renderImage(!0)),this},scaleX:function(t){var i=this.imageData.scaleY;return this.scale(t,h(i)?i:1)},scaleY:function(t){var i=this.imageData.scaleX;return this.scale(h(i)?i:1,t)},getData:function(t){var i,e,a=this.options,h=this.imageData,n=this.canvasData,s=this.cropBoxData;return this.built&&this.cropped?(e={x:s.left-n.left,y:s.top-n.top,width:s.width,height:s.height},i=h.width/h.naturalWidth,g(e,function(a,h){a/=i,e[h]=t?It(a):a})):e={x:0,y:0,width:0,height:0},a.rotatable&&(e.rotate=h.rotate||0),a.scalable&&(e.scaleX=h.scaleX||1,e.scaleY=h.scaleY||1),e},setData:function(t){var i,e,a,n=this.options,s=this.imageData,c=this.canvasData,p={};return r(t)&&(t=t.call(this.element)),this.built&&!this.disabled&&o(t)&&(n.rotatable&&h(t.rotate)&&t.rotate!==s.rotate&&(s.rotate=t.rotate,this.rotated=i=!0),n.scalable&&(h(t.scaleX)&&t.scaleX!==s.scaleX&&(s.scaleX=t.scaleX,e=!0),h(t.scaleY)&&t.scaleY!==s.scaleY&&(s.scaleY=t.scaleY,e=!0)),i?this.renderCanvas():e&&this.renderImage(),a=s.width/s.naturalWidth,h(t.x)&&(p.left=t.x*a+c.left),h(t.y)&&(p.top=t.y*a+c.top),h(t.width)&&(p.width=t.width*a),h(t.height)&&(p.height=t.height*a),this.setCropBoxData(p)),this},getContainerData:function(){return this.built?this.containerData:{}},getImageData:function(){return this.ready?this.imageData:{}},getCanvasData:function(){var t=this.canvasData,i={};return this.built&&g(["left","top","width","height","naturalWidth","naturalHeight"],function(e){i[e]=t[e]}),i},setCanvasData:function(t){var i=this.canvasData,e=i.aspectRatio;return r(t)&&(t=t.call(this.element)),this.built&&!this.disabled&&o(t)&&(h(t.left)&&(i.left=t.left),h(t.top)&&(i.top=t.top),h(t.width)?(i.width=t.width,i.height=t.width/e):h(t.height)&&(i.height=t.height,i.width=t.height*e),this.renderCanvas(!0)),this},getCropBoxData:function(){var t,i=this.cropBoxData;return this.built&&this.cropped&&(t={left:i.left,top:i.top,width:i.width,height:i.height}),t||{}},setCropBoxData:function(t){var i,e,a=this.cropBoxData,n=this.options.aspectRatio;return r(t)&&(t=t.call(this.element)),this.built&&this.cropped&&!this.disabled&&o(t)&&(h(t.left)&&(a.left=t.left),h(t.top)&&(a.top=t.top),h(t.width)&&t.width!==a.width&&(i=!0,a.width=t.width),h(t.height)&&t.height!==a.height&&(e=!0,a.height=t.height),n&&(i?a.height=a.width/n:e&&(a.width=a.height*n)),this.renderCropBox()),this},getCroppedCanvas:function(t){var i,e,a,h,n,s,r,c,p,l,d;return this.built&&this.cropped&&Wt?(o(t)||(t={}),d=this.getData(),i=d.width,e=d.height,c=i/e,o(t)&&(n=t.width,s=t.height,n?(s=n/c,r=n/i):s&&(n=s*c,r=s/e)),a=It(n||i),h=It(s||e),p=U.createElement("canvas"),p.width=a,p.height=h,l=p.getContext("2d"),t.fillColor&&(l.fillStyle=t.fillColor,l.fillRect(0,0,a,h)),l.drawImage.apply(l,function(){var t,a,h,n,s,o,c=_(this.image,this.imageData),p=c.width,l=c.height,u=[c],g=d.x,f=d.y;return-i>=g||g>p?g=t=h=s=0:0>=g?(h=-g,g=0,t=s=Ht(p,i+g)):p>=g&&(h=0,t=s=Ht(i,p-g)),0>=t||-e>=f||f>l?f=a=n=o=0:0>=f?(n=-f,f=0,a=o=Ht(l,e+f)):l>=f&&(n=0,a=o=Ht(e,l-f)),u.push(g,f,t,a),r&&(h*=r,n*=r,s*=r,o*=r),s>0&&o>0&&u.push(h,n,s,o),u}.call(this)),p):void 0},setAspectRatio:function(t){var i=this.options;return this.disabled||n(t)||(i.aspectRatio=Mt(0,t)||NaN,this.built&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(t){var i,e,a=this.options,h=this.dragBox,n=this.face;return this.ready&&!this.disabled&&(i=a.dragCrop&&t===Bt,e=a.movable&&t===Tt,t=i||e?t:Yt,y(h,gt,t),D(h,J,i),D(h,G,e),a.cropBoxMovable||(y(n,gt,t),D(n,J,i),D(n,G,e))),this}}),f(Z.prototype,Nt),Z.DEFAULTS={aspectRatio:NaN,data:null,preview:"",strict:!0,responsive:!0,checkImageOrigin:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,dragCrop:!0,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,mouseWheelZoom:!0,wheelZoomRatio:.1,touchDragZoom:!0,cropBoxMovable:!0,cropBoxResizable:!0,doubleClickToggle:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:200,minContainerHeight:100,build:null,built:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},Z.TEMPLATE='<div class="cropper-container"><div class="cropper-canvas"></div><div class="cropper-drag-box"><div class="cropper-crop-box"><span class="cropper-view-box"></span><span class="cropper-dashed dashed-h"></span><span class="cropper-dashed dashed-v"></span><span class="cropper-center"></span><span class="cropper-face"></span><span class="cropper-line line-e" data-action="e"></span><span class="cropper-line line-n" data-action="n"></span><span class="cropper-line line-w" data-action="w"></span><span class="cropper-line line-s" data-action="s"></span><span class="cropper-point point-e" data-action="e"></span><span class="cropper-point point-n" data-action="n"></span><span class="cropper-point point-w" data-action="w"></span><span class="cropper-point point-s" data-action="s"></span><span class="cropper-point point-ne" data-action="ne"></span><span class="cropper-point point-nw" data-action="nw"></span><span class="cropper-point point-sw" data-action="sw"></span><span class="cropper-point point-se" data-action="se"></span></div></div></div>';var Ot=t.Cropper;return Z.noConflict=function(){return t.Cropper=Ot,Z},Z.setDefaults=function(t){f(Z.DEFAULTS,t)},"function"==typeof define&&define.amd&&define("cropper",[],function(){return Z}),"undefined"==typeof i&&(t.Cropper=Z),Z});